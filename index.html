<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä –∏–≥—Ä—ã "–í —Ü–≤–µ—Ç–æ—á–Ω–æ–º –æ–≥–æ—Ä–æ–¥–µ"</title>
    <style>
        :root { --primary: #4f46e5; --bg: #f3f4f6; }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--primary); margin-bottom: 20px; }
        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; }
        .section h2 { margin-top: 0; font-size: 1.2rem; color: #1f2937; border-bottom: 2px solid var(--primary); padding-bottom: 10px; display: inline-block; }
        label { display: block; margin-top: 15px; font-weight: 500; font-size: 0.9rem; }
        input[type="text"], select, textarea { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #d1d5db; border-radius: 6px; box-sizing: border-box; }
        input[type="file"] { margin-top: 5px; }
        .row { display: flex; gap: 20px; }
        .col { flex: 1; }
        .preview-box { margin-top: 10px; max-width: 100px; max-height: 100px; border: 1px dashed #ccc; display: none; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
        .category-block { padding: 15px; border-radius: 8px; margin-top: 10px; }
        .cat-red { background: #fee2e2; border: 1px solid #fca5a5; }
        .cat-blue { background: #dbeafe; border: 1px solid #93c5fd; }
        .cat-green { background: #dcfce7; border: 1px solid #86efac; }

        button.generate-btn { background: var(--primary); color: white; border: none; padding: 15px 30px; font-size: 1.1rem; border-radius: 8px; cursor: pointer; width: 100%; transition: 0.2s; }
        button.generate-btn:hover { background: #4338ca; }
        
        #outputArea { margin-top: 30px; display: none; }
        textarea#finalCode { font-family: monospace; height: 200px; background: #1f2937; color: #a5f3fc; }
        .note { font-size: 0.8rem; color: #666; margin-top: 2px; }
    </style>
</head>
<body>

<div class="container">
    <h1>üé® –†–µ–¥–∞–∫—Ç–æ—Ä: –í —Ü–≤–µ—Ç–æ—á–Ω–æ–º –æ–≥–æ—Ä–æ–¥–µ</h1>
    <p style="text-align: center; margin-bottom: 30px;">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –≤–µ—Ä—Å–∏—é –∏–≥—Ä—ã –¥–ª—è Genially. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å".</p>

    <div class="section">
        <h2>1. –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="row">
            <div class="col">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã (–ó–∞–≥–æ–ª–æ–≤–æ–∫)</label>
                <input type="text" id="gameTitle" value="–ò–≥—Ä–∞ ¬´–í —Ü–≤–µ—Ç–æ—á–Ω–æ–º –æ–≥–æ—Ä–æ–¥–µ¬ª">
            </div>
            <div class="col">
                <label>–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</label>
                <select id="gameLang">
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    <option value="de" selected>Deutsch</option>
                    <option value="en">English</option>
                    <option value="fr">Fran√ßais</option>
                    <option value="es">Espa√±ol</option>
                    <option value="it">Italiano</option>
                    <option value="cn">‰∏≠Êñá</option>
                    <option value="jp">Êó•Êú¨Ë™û</option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <label>–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–°—Ç–∞—Ä—Ç"</label>
                <input type="text" id="textStart" value="Starten">
            </div>
            <div class="col">
                <label>–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–§–∏–Ω–∏—à/–ü–æ–±–µ–¥–∞"</label>
                <input type="text" id="textFinish" value="Gut gemacht!">
            </div>
            <div class="col">
                <label>–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å"</label>
                <input type="text" id="textRepeat" value="Nochmal">
            </div>
        </div>
    </div>

    <div class="section">
        <h2>2. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏ –ú–µ–¥–∏–∞</h2>
        
        <label>–§–æ–Ω–æ–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ (–°–∞–¥)</label>
        <input type="file" id="bgInput" accept="image/*">
        <input type="text" id="bgUrl" placeholder="–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É">
        <div class="note">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (Base64)</div>

        <div class="row">
            <div class="col">
                <label>–ü–µ—Ä—Å–æ–Ω–∞–∂ (–•—É–¥–æ–∂–Ω–∏–∫)</label>
                <input type="file" id="heroInput" accept="image/*">
            </div>
            <div class="col">
                <label>–ê–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç (–ó–ª–∞—è –ø—á–µ–ª–∞)</label>
                <input type="file" id="enemyInput" accept="image/*">
            </div>
        </div>

        <label>–§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ (MP3)</label>
        <input type="file" id="musicInput" accept="audio/*">
        
        <label>–ó–≤—É–∫ –æ—à–∏–±–∫–∏ (–ñ—É–∂–∂–∞–Ω–∏–µ)</label>
        <input type="file" id="failSoundInput" accept="audio/*">
    </div>

    <div class="section">
        <h2>3. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –°–ª–æ–≤–∞ (–õ–µ–≥–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)</h2>
        <p class="note">–ó–¥–µ—Å—å –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ "–õ–µ–π–∫–∏". –í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.</p>

        <div class="category-block cat-red">
            <label>üî¥ –ö—Ä–∞—Å–Ω–∞—è –õ–µ–π–∫–∞ (–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)</label>
            <input type="text" id="cat1Name" value="Die (–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥)">
            
            <label>–°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –ö—Ä–∞—Å–Ω–æ–π –ª–µ–π–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
            <textarea id="cat1Words" rows="3">Katze, Maus, Kuh, Biene, Spinne, Ziege, Gans, Schlange, Fliege, Ameise</textarea>
        </div>

        <div class="category-block cat-blue">
            <label>üîµ –°–∏–Ω—è—è –õ–µ–π–∫–∞ (–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)</label>
            <input type="text" id="cat2Name" value="Der (–ú—É–∂—Å–∫–æ–π —Ä–æ–¥)">
            
            <label>–°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –°–∏–Ω–µ–π –ª–µ–π–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
            <textarea id="cat2Words" rows="3">Hund, Fisch, Hamster, Delphin, Vogel, L√∂we, Elefant, Affe, Hai, Igel</textarea>
        </div>

        <div class="category-block cat-green">
            <label>üü¢ –ó–µ–ª–µ–Ω–∞—è –õ–µ–π–∫–∞ (–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)</label>
            <input type="text" id="cat3Name" value="Das (–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥)">
            
            <label>–°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –ó–µ–ª–µ–Ω–æ–π –ª–µ–π–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
            <textarea id="cat3Words" rows="3">Pferd, Nashorn, Reh, Schwein, Huhn, Schaf, Krokodil, Kaninchen, Wildschwein, K√§nguru</textarea>
        </div>
    </div>

    <div class="section">
        <h2>4. –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)</h2>
        <p class="note">–§–æ—Ä–º–∞—Ç: "–¢–µ–∫—Å—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å –ø—Ä–æ–ø—É—Å–∫–æ–º | –ù–æ–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–µ–π–∫–∏ (1, 2 –∏–ª–∏ 3)". –ö–∞–∂–¥–æ–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏.</p>
        <p class="note">–ü—Ä–∏–º–µ—Ä: ___ Hund spielt. | 2</p>
        <textarea id="mediumContent" rows="6" placeholder="___ Katze trinkt Milch. | 1
___ Pferd steht. | 3
___ Hund bellt. | 2"></textarea>
    </div>

    <button class="generate-btn" onclick="generateGame()">üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è Genially</button>

    <div id="outputArea" class="section">
        <h2>–ì–æ—Ç–æ–≤—ã–π –∫–æ–¥</h2>
        <p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ Genially —á–µ—Ä–µ–∑ <b>Insert -> Others -> iframe</b>.</p>
        <textarea id="finalCode" readonly></textarea>
        <button onclick="copyCode()" style="margin-top:10px; padding:5px 10px; cursor:pointer;">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä</button>
    </div>

</div>

<script>
    // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –≤ Base64
    const assets = {
        bg: '',
        hero: '',
        enemy: '',
        music: '',
        failSound: ''
    };

    // –§—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞ –≤ Base64
    function handleFileSelect(event, key) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                assets[key] = e.target.result;
                console.log(`Loaded ${key}`);
            };
            reader.readAsDataURL(file);
        }
    }

    // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π –∑–∞–≥—Ä—É–∑–∫–∏
    document.getElementById('bgInput').addEventListener('change', (e) => handleFileSelect(e, 'bg'));
    document.getElementById('heroInput').addEventListener('change', (e) => handleFileSelect(e, 'hero'));
    document.getElementById('enemyInput').addEventListener('change', (e) => handleFileSelect(e, 'enemy'));
    document.getElementById('musicInput').addEventListener('change', (e) => handleFileSelect(e, 'music'));
    document.getElementById('failSoundInput').addEventListener('change', (e) => handleFileSelect(e, 'failSound'));

    function generateGame() {
        // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–æ–ª–µ–π
        const config = {
            title: document.getElementById('gameTitle').value,
            lang: document.getElementById('gameLang').value,
            texts: {
                start: document.getElementById('textStart').value,
                finish: document.getElementById('textFinish').value,
                repeat: document.getElementById('textRepeat').value
            },
            categories: [
                { id: 1, name: document.getElementById('cat1Name').value, color: 'red', words: document.getElementById('cat1Words').value.split(',').map(s => s.trim()) },
                { id: 2, name: document.getElementById('cat2Name').value, color: 'blue', words: document.getElementById('cat2Words').value.split(',').map(s => s.trim()) },
                { id: 3, name: document.getElementById('cat3Name').value, color: 'green', words: document.getElementById('cat3Words').value.split(',').map(s => s.trim()) }
            ],
            mediumLevel: document.getElementById('mediumContent').value.split('\n').filter(line => line.includes('|')).map(line => {
                const parts = line.split('|');
                return { text: parts[0].trim(), correctCat: parseInt(parts[1].trim()) };
            }),
            assets: {
                bg: assets.bg || document.getElementById('bgUrl').value || 'https://images.unsplash.com/photo-1585320806297-9794b3e4eeae?auto=format&fit=crop&w=1000&q=80', // –î–µ—Ñ–æ–ª—Ç
                hero: assets.hero,
                enemy: assets.enemy,
                music: assets.music,
                failSound: assets.failSound
            }
        };

        // –ì–ï–ù–ï–†–ê–¶–ò–Ø HTML –ö–û–î–ê –ò–ì–†–´
        // –ó–¥–µ—Å—å –º—ã —Å–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Å –ø–æ–ª–Ω—ã–º HTML –∫–æ–¥–æ–º –∏–≥—Ä—ã, –≤–Ω–µ–¥—Ä—è—è –≤ –Ω–µ—ë config
        
        const gameHTML = `
<!DOCTYPE html>
<html>
<head>
<style>
  body { margin:0; overflow:hidden; font-family: sans-serif; background: url('${config.assets.bg}') center/cover no-repeat; }
  #game-ui { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
  .can-container { display: flex; gap: 20px; position: absolute; bottom: 20px; width: 100%; justify-content: center; }
  .can { width: 100px; height: 100px; cursor: pointer; transition: transform 0.2s; background: white; border-radius: 10px; display:flex; align-items:center; justify-content:center; font-weight:bold; border: 3px solid #333; }
  .can:hover { transform: scale(1.1); }
  .can.red { border-color: #ef4444; color: #ef4444; }
  .can.blue { border-color: #3b82f6; color: #3b82f6; }
  .can.green { border-color: #22c55e; color: #22c55e; }
  
  #word-display { background: rgba(255,255,255,0.9); padding: 20px 40px; border-radius: 15px; font-size: 2rem; font-weight: bold; margin-bottom: 100px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
  
  #progress-bar { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; }
  .drop { width: 20px; height: 20px; background: #ccc; border-radius: 50%; border-top-right-radius: 0; transform: rotate(-45deg); }
  .drop.filled { background: #3b82f6; box-shadow: 0 0 5px cyan; }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—á–µ–ª—ã */
  #bee { position: absolute; width: 80px; height: 80px; top: -100px; right: -100px; transition: 1s; }
  .bee-attack { top: 50% !important; right: 50% !important; transform: scale(1.5); }

  #start-screen, #win-screen { position: absolute; inset: 0; background: rgba(255,255,255,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
  button.btn { padding: 15px 30px; font-size: 1.5rem; background: #4f46e5; color: white; border: none; border-radius: 10px; cursor: pointer; }
</style>
</head>
<body>

<div id="start-screen">
    <h1>${config.title}</h1>
    <button class="btn" onclick="startGame()">${config.texts.start}</button>
</div>

<div id="game-ui" style="display:none;">
    <div id="progress-bar">
        </div>

    <div id="word-display">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    
    <img src="${config.assets.hero || ''}" style="height: 200px; position: absolute; left: 10%; bottom: 150px;">
    
    <img id="bee" src="${config.assets.enemy || 'https://cdn-icons-png.flaticon.com/512/3069/3069186.png'}">

    <div class="can-container">
        <div class="can red" onclick="checkAnswer(1)">${config.categories[0].name}</div>
        <div class="can blue" onclick="checkAnswer(2)">${config.categories[1].name}</div>
        <div class="can green" onclick="checkAnswer(3)">${config.categories[2].name}</div>
    </div>
</div>

<script>
    // –í–°–¢–†–û–ï–ù–ù–´–ô –ö–û–ù–§–ò–ì
    const gameData = ${JSON.stringify(config)};
    
    let currentWord = null;
    let score = 0;
    const maxScore = 10;
    
    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-ui').style.display = 'flex';
        initDrops();
        nextWord();
    }

    function initDrops() {
        const bar = document.getElementById('progress-bar');
        bar.innerHTML = '';
        for(let i=0; i<maxScore; i++) {
            const d = document.createElement('div');
            d.className = 'drop';
            d.id = 'drop-'+i;
            bar.appendChild(d);
        }
    }

    function getRandomWord() {
        // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞: –±–µ—Ä–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –ø–æ—Ç–æ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ
        const catIndex = Math.floor(Math.random() * 3);
        const cat = gameData.categories[catIndex];
        const word = cat.words[Math.floor(Math.random() * cat.words.length)];
        return { text: word, catId: cat.id };
    }

    function nextWord() {
        currentWord = getRandomWord();
        document.getElementById('word-display').textContent = currentWord.text;
        // –°–±—Ä–æ—Å –ø—á–µ–ª—ã
        const bee = document.getElementById('bee');
        bee.classList.remove('bee-attack');
    }

    function checkAnswer(selectedId) {
        if (selectedId === currentWord.catId) {
            // Success
            document.getElementById('drop-' + score).classList.add('filled');
            score++;
            if (score >= maxScore) {
                alert(gameData.texts.finish); // –¢—É—Ç –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π Win Screen
                location.reload();
            } else {
                nextWord();
            }
        } else {
            // Fail - Bee Attack
            const bee = document.getElementById('bee');
            bee.classList.add('bee-attack');
            // –ó–≤—É–∫ –∂—É–∂–∂–∞–Ω–∏—è
            if(gameData.assets.failSound) {
                 new Audio(gameData.assets.failSound).play();
            }
        }
    }
<\/script>
</body>
</html>
        `;

        // –í—ã–≤–æ–¥ –≥–æ—Ç–æ–≤–æ–≥–æ iframe –∫–æ–¥–∞
        document.getElementById('outputArea').style.display = 'block';
        document.getElementById('finalCode').value = gameHTML;
    }

    function copyCode() {
        const copyText = document.getElementById("finalCode");
        copyText.select();
        document.execCommand("copy");
        alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –í—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ Genially (Insert > Others).");
    }
</script>

</body>
</html>
