<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Deutsch interaktiv | –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ò–≥—Ä</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6C5CE7; --a: #FD79A8; --bg: #F4F7FA; }
        body { font-family: 'Montserrat', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #2D3436; }
        .wrapper { max-width: 900px; margin: 0 auto; background: white; border-radius: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* HEADER */
        .header { background: var(--p); padding: 30px; color: white; display: flex; align-items: center; justify-content: space-between; }
        .logo-box { display: flex; align-items: center; gap: 15px; }
        .circle { background: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--p); font-size: 24px; font-weight: 900; }
        
        .main { padding: 30px; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; }
        .block { background: #F9F9FB; padding: 15px; border-radius: 20px; border: 1px solid #EEE; }
        
        label { display: block; font-weight: 900; font-size: 10px; color: var(--p); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
        input, textarea, select { width: 100%; border: 2px solid #E0E0E0; border-radius: 12px; padding: 12px; font-family: inherit; box-sizing: border-box; font-size: 14px; }
        textarea { height: 120px; resize: none; border-bottom: 3px solid var(--a); }

        /* –ö–ù–û–ü–ö–ê –ì–ï–ù–ï–†–ê–¶–ò–ò */
        .btn-gen { background: var(--a); color: white; border: none; width: 100%; padding: 25px; border-radius: 25px; font-size: 20px; font-weight: 900; cursor: pointer; transition: 0.3s; box-shadow: 0 10px 30px rgba(253, 121, 168, 0.4); }
        .btn-gen:hover { transform: translateY(-3px); filter: brightness(1.1); }

        /* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û */
        #modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; align-items:center; justify-content:center; }
        .modal-content { background:white; padding:40px; border-radius:40px; width:80%; max-width:700px; text-align:center; }
        #code-res { background:#1e272e; color:#0be881; padding:20px; border-radius:15px; font-family:monospace; font-size:11px; height:200px; overflow-y:auto; word-break:break-all; text-align:left; margin:20px 0; border: 4px solid #34495e; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="header">
        <div class="logo-box">
            <div class="circle">DI</div>
            <div>
                <h1 style="margin:0; font-size:22px;">Deutsch interaktiv</h1>
                <p style="margin:0; font-size:11px; opacity:0.8;">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä: –¶–≤–µ—Ç–æ—á–Ω—ã–π –æ–≥–æ—Ä–æ–¥</p>
            </div>
        </div>
        <select id="lang_sel" style="width:140px; background: rgba(255,255,255,0.2); color: white; border: none;">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option><option value="de">Deutsch</option>
        </select>
    </div>

    <div class="main">
        <div class="grid" style="grid-template-columns: 2fr 1fr;">
            <div class="block"><label>–§–æ–Ω –∏–≥—Ä—ã (URL –∫–∞—Ä—Ç–∏–Ω–∫–∏)</label><input type="text" id="bg_url" value="https://img.freepik.com/free-vector/spring-landscape-scene_23-2148849842.jpg"></div>
            <div class="block"><label>–ù—É–∂–Ω–æ –±–∞–ª–ª–æ–≤</label><input type="number" id="win_score" value="10"></div>
        </div>

        <div class="grid">
            <div class="block"><label style="color:#448aff">DER (—Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label><textarea id="words_der">Hund, Fisch, Hamster, Vogel, L√∂we, Affe, Igel, Hai, Elefant</textarea></div>
            <div class="block"><label style="color:#ff5252">DIE (—Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label><textarea id="words_die">Katze, Maus, Kuh, Biene, Spinne, Ziege, Gans, Schlange, Fliege</textarea></div>
            <div class="block"><label style="color:#2ecc71">DAS (—Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label><textarea id="words_das">Pferd, Nashorn, Reh, Schwein, Huhn, Schaf, Krokodil, Kaninchen, K√§nguru</textarea></div>
        </div>

        <button class="btn-gen" onclick="generateGame()">–°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ò–ì–†–£</button>
    </div>
</div>

<div id="modal">
    <div class="modal-content">
        <h2 style="color:var(--p); margin:0;">–ö–û–î –ì–û–¢–û–í!</h2>
        <p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ Genially —á–µ—Ä–µ–∑ <b>Insert -> Others</b></p>
        <div id="code-res"></div>
        <button class="btn-gen" onclick="copyCode()">–°–ö–û–ü–ò–†–û–í–ê–¢–¨ –ö–û–î</button>
        <p onclick="document.getElementById('modal').style.display='none'" style="margin-top:20px; cursor:pointer; color:gray; text-decoration:underline;">–ó–∞–∫—Ä—ã—Ç—å</p>
    </div>
</div>

<script>
    function generateGame() {
        const bg = document.getElementById('bg_url').value;
        const winLimit = document.getElementById('win_score').value;
        
        const clean = (id) => document.getElementById(id).value.split(',').map(s => s.trim()).filter(s => s !== "");
        
        const der = clean('words_der');
        const die = clean('words_die');
        const das = clean('words_das');

        // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        const dbContent = [
            ...der.map(w => `{word:"${w}", gender:"der"}`),
            ...die.map(w => `{word:"${w}", gender:"die"}`),
            ...das.map(w => `{word:"${w}", gender:"das"}`)
        ].join(',');

        // –ü–æ–ª–Ω—ã–π –∫–æ–¥ –∏–≥—Ä—ã —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        const gameTemplate = `<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><style>body{font-family:'Comic Sans MS',sans-serif;background:#e0f7fa;text-align:center;margin:0;padding:0;overflow:hidden}#game-container{width:100%;max-width:800px;height:100vh;margin:0 auto;background:url('${bg}') no-repeat center center;background-size:cover;position:relative;display:flex;flex-direction:column;justify-content:space-between}#top-bar{background:rgba(255,255,255,.8);padding:10px;border-radius:0 0 15px 15px;display:flex;justify-content:space-between;align-items:center}#progress-bar{flex-grow:1;height:20px;background:#ddd;border-radius:10px;margin:0 10px;position:relative;overflow:hidden}#progress-fill{height:100%;width:0%;background:#4fc3f7;transition:width .5s}#main-area{flex-grow:1;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}#visual-target{font-size:100px;transition:filter .5s;filter:grayscale(100%);cursor:pointer;text-shadow:0 0 10px white}.glow{filter:grayscale(0%) drop-shadow(0 0 20px gold)!important;transform:scale(1.1)}#watering-cans{display:flex;justify-content:center;gap:20px;margin-bottom:20px}.can{width:80px;height:80px;border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;border:3px solid white;box-shadow:0 4px 6px rgba(0,0,0,.3);transition:transform .2s;background:white}.can:active{transform:scale(.9)}.can.die{background:#ff5252;color:white}.can.der{background:#448aff;color:white}.can.das{background:#69f0ae;color:black}.can.active{transform:scale(1.2);border:5px solid #ff0;z-index:10}.can-img{font-size:40px}#question-area{background:rgba(255,255,255,.9);width:90%;padding:20px;border-radius:15px 15px 0 0;min-height:150px}.word-btn{padding:10px 20px;font-size:18px;margin:5px;border:none;border-radius:20px;cursor:pointer;background:#fff;border:2px solid #333;transition:.3s}.word-btn:hover{background:#eee}#bee-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;z-index:100;flex-direction:column;align-items:center;justify-content:center}#bee-img{font-size:150px;animation:shake .5s infinite}@keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px,0px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}100%{transform:translate(1px,-2px) rotate(-1deg)}}#menu{position:absolute;top:0;left:0;width:100%;height:100%;background:#fff;z-index:200;display:flex;flex-direction:column;align-items:center;justify-content:center}.menu-btn{padding:15px 30px;font-size:24px;margin:10px;cursor:pointer;background:orange;border:none;border-radius:10px;color:white}</style></head><body><div id="game-container"><div id="top-bar"><span id="score-display">–°—á–µ—Ç: 0</span><div id="progress-bar"><div id="progress-fill"></div></div></div><div id="main-area"><div id="visual-target">ü¶ã</div><div id="feedback-text" style="font-size:24px;font-weight:bold;height:30px;margin-top:10px;color:#333"></div></div><div id="watering-cans"><div class="can die" id="can-die" onclick="handleCanClick('die')"><span class="can-img">üöø</span><b>DIE</b></div><div class="can der" id="can-der" onclick="handleCanClick('der')"><span class="can-img">üöø</span><b>DER</b></div><div class="can das" id="can-das" onclick="handleCanClick('das')"><span class="can-img">üöø</span><b>DAS</b></div></div><div id="question-area"><h3 id="instruction-text">–ó–∞–≥—Ä—É–∑–∫–∞...</h3><div id="options-container"></div></div><div id="bee-overlay"><div id="bee-img">üêù</div><h1 style="color:white;font-family:Arial">–û–π! –û—à–∏–±–∫–∞!</h1></div><div id="menu"><h1>Deutsch Interaktiv</h1><p>–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å:</p><button class="menu-btn" onclick="startLevel('easy')">–õ—ë–≥–∫–∏–π (–ë–∞–±–æ—á–∫–∞)</button><button class="menu-btn" onclick="startLevel('medium')">–°—Ä–µ–¥–Ω–∏–π (–¶–≤–µ—Ç–æ–∫)</button></div></div><script>const db=[${dbContent}];let currentLevel='',score=0,currentTask=null,targetGender=null;const audioContext=new(window.AudioContext||window.webkitAudioContext);function playSound(e){const t=audioContext.createOscillator(),n=audioContext.createGain();t.connect(n),n.connect(audioContext.destination),"success"===e?(t.type="sine",t.frequency.setValueAtTime(500,audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(1e3,audioContext.currentTime+.1),n.gain.exponentialRampToValueAtTime(.01,audioContext.currentTime+.5),t.start(),t.stop(audioContext.currentTime+.5)):"error"===e&&(t.type="sawtooth",t.frequency.setValueAtTime(150,audioContext.currentTime),t.frequency.linearRampToValueAtTime(100,audioContext.currentTime+.5),n.gain.exponentialRampToValueAtTime(.01,audioContext.currentTime+.5),t.start(),t.stop(audioContext.currentTime+.5))}function startLevel(e){currentLevel=e,document.getElementById("menu").style.display="none",score=0,updateUI(),"easy"===e?(document.getElementById("visual-target").innerText="ü¶ã",generateEasyTask()):(document.getElementById("visual-target").innerText="üèµÔ∏è",generateMediumTask())}function generateEasyTask(){resetVisuals();const e=["die","der","das"];targetGender=e[Math.floor(3*Math.random())],highlightCan(targetGender);const t=db.filter(e=>e.gender===targetGender),n=t[Math.floor(Math.random()*t.length)],a=db.filter(e=>e.gender!==targetGender).sort(()=>.5-Math.random()).slice(0,2),r=[n,...a].sort(()=>.5-Math.random());document.getElementById("instruction-text").innerText=\`–õ–µ–π–∫–∞ "\${targetGender.toUpperCase()}". –í—ã–±–µ—Ä–∏ —Å–ª–æ–≤–æ:\`;const l=document.getElementById("options-container");l.innerHTML="",r.forEach(e=>{const t=document.createElement("button");t.className="word-btn",t.innerText=e.word,t.onclick=()=>checkEasyAnswer(e),l.appendChild(t)})}function checkEasyAnswer(e){e.gender===targetGender?(handleSuccess(e.gender),setTimeout(generateEasyTask,2e3)):handleError()}function generateMediumTask(){resetVisuals(),document.querySelectorAll(".can").forEach(e=>e.classList.remove("active")),currentTask=db[Math.floor(Math.random()*db.length)];const e=["frisst","schl√§ft","l√§uft","steht"][Math.floor(4*Math.random())];document.getElementById("instruction-text").innerText=\`___ \${currentTask.word} \${e}. (–ö–ª–∏–∫–Ω–∏ –Ω–∞ –ª–µ–π–∫—É)\`,document.getElementById("options-container").innerHTML=""}function handleCanClick(e){"medium"===currentLevel&&(e===currentTask.gender?(document.getElementById("instruction-text").innerText=\`\${e.charAt(0).toUpperCase()+e.slice(1)} \${currentTask.word} ... ‚úî\`,handleSuccess(e),setTimeout(generateMediumTask,2e3)):handleError())}function highlightCan(e){document.querySelectorAll(".can").forEach(e=>e.classList.remove("active")),document.getElementById(\`can-\${e}\`).classList.add("active")}function handleSuccess(e){score++,playSound("success"),updateUI();const t=document.getElementById("visual-target");t.classList.add("glow"),"die"===e&&(t.style.filter="drop-shadow(0 0 10px red) hue-rotate(0deg)"),"der"===e&&(t.style.filter="drop-shadow(0 0 10px blue) hue-rotate(180deg)"),"das"===e&&(t.style.filter="drop-shadow(0 0 10px green) hue-rotate(90deg)"),document.getElementById("feedback-text").innerText="Richtig!",document.getElementById("feedback-text").style.color="green"}function handleError(){playSound("error");const e=document.getElementById("bee-overlay");e.style.display="flex",setTimeout(()=>{e.style.display="none"},2e3)}function resetVisuals(){const e=document.getElementById("visual-target");e.classList.remove("glow"),e.style.filter="grayscale(100%)",document.getElementById("feedback-text").innerText=""}function updateUI(){document.getElementById("score-display").innerText=\`–ö–∞–ø–ª–∏: \${score}\`;const e=Math.min(score/${winLimit}*100,100);document.getElementById("progress-fill").style.width=\`\${e}%\`,score>=${winLimit}&&(alert("–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!"),location.reload())}<\/script></body></html>`;

        const finalIframe = `<iframe srcdoc='${gameTemplate.replace(/'/g, "&#39;")}' width='100%' height='600' frameborder='0'></iframe>`;
        
        document.getElementById('code-res').innerText = finalIframe;
        document.getElementById('modal').style.display = 'flex';
    }

    function copyCode() {
        const text = document.getElementById('code-res').innerText;
        navigator.clipboard.writeText(text);
        alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –¢–µ–ø–µ—Ä—å –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ Genially.");
    }
</script>

</body>
</html>
