<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Deutsch interaktiv | Grand Master Editor 21.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6C5CE7; --a: #FD79A8; --ok: #00B894; --bg: #f0f2f5; --dark: #2D3436; }
        body { font-family: 'Montserrat', sans-serif; margin: 0; background: var(--bg); display: flex; height: 100vh; overflow: hidden; }

        /* –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –ù–ê–°–¢–†–û–ô–ö–ò */
        .editor-sidebar { width: 450px; background: white; border-right: 6px solid var(--p); display: flex; flex-direction: column; box-shadow: 10px 0 30px rgba(0,0,0,0.1); z-index: 10; }
        .editor-header { padding: 20px; border-bottom: 2px solid #eee; display: flex; align-items: center; gap: 15px; }
        .scroll-box { padding: 20px; overflow-y: auto; flex: 1; }

        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –ü–†–ï–î–ü–†–û–°–ú–û–¢–† */
        .preview-zone { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #dfe6e9; position: relative; }
        .screen { width: 90%; aspect-ratio: 16/9; background: white; border-radius: 30px; border: 10px solid var(--dark); position: relative; overflow: hidden; box-shadow: 0 40px 80px rgba(0,0,0,0.3); background-size: cover; }

        /* –ö–ê–†–¢–û–ß–ö–ò –ö–ê–¢–ï–ì–û–†–ò–ô */
        .cat-card { background: #f8f9ff; border-radius: 20px; padding: 15px; margin-bottom: 15px; border: 2px solid #e1e2ef; }
        .v-selector { display: flex; gap: 5px; margin: 10px 0; }
        .v-item { cursor: pointer; font-size: 1.2rem; padding: 5px; border-radius: 8px; border: 2px solid transparent; grayscale: 100%; transition: 0.2s; }
        .v-item.active { border-color: var(--a); grayscale: 0; background: white; transform: scale(1.1); }

        /* –ò–ì–†–û–í–´–ï –≠–õ–ï–ú–ï–ù–¢–´ –í –ü–†–ï–í–¨–Æ */
        #preview-artist { position: absolute; bottom: 30px; left: 30px; width: 140px; z-index: 5; }
        #preview-bee { position: absolute; top: 10%; left: -100px; width: 70px; z-index: 10; }
        #preview-obj { position: absolute; top: 50%; left: 55%; transform: translate(-50%, -50%); width: 400px; }
        #preview-word { position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); background: white; padding: 15px 40px; border-radius: 30px; border: 4px solid var(--p); font-weight: 900; font-size: 1.8rem; }

        /* –ö–ù–û–ü–ö–ò */
        .btn-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 20px; background: white; border-top: 2px solid #eee; }
        .btn { padding: 15px; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; text-transform: uppercase; transition: 0.2s; color: white; }
        .btn-p { background: var(--p); }
        .btn-a { background: var(--a); }
        .btn-iframe { background: var(--dark); grid-column: span 2; }
        .btn:hover { transform: translateY(-2px); filter: brightness(1.1); }

        /* –°–ö–†–´–¢–´–ô –ò–ù–ü–£–¢ –§–ê–ô–õ–û–í */
        .file-input { display: none; }
        .file-label { display: block; padding: 10px; background: #eee; text-align: center; border-radius: 10px; cursor: pointer; margin-top: 5px; font-size: 0.8rem; font-weight: 700; }

        /* SVG –°–ï–ì–ú–ï–ù–¢–´ */
        .seg { stroke: #333; stroke-width: 1px; transition: 0.5s; }
        .fx-fire { filter: drop-shadow(0 0 8px orange); }
        .fx-shine { filter: drop-shadow(0 0 10px gold); }
    </style>
</head>
<body>

<div class="editor-sidebar">
    <div class="editor-header">
        <img src="https://raw.githubusercontent.com/irinschensmagen-alt/Redaktor-/main/logo.png" width="60">
        <div>
            <h2 style="margin:0; font-size:1.1rem; color:var(--p);">DEUTSCH INTERAKTIV</h2>
            <span style="font-size:0.6rem; font-weight:900; color:var(--a);">PRO BUILD 2026</span>
        </div>
    </div>

    <div class="scroll-box">
        <div class="cat-card">
            <label style="font-size:0.7rem; font-weight:900;">–Ø–ó–´–ö –ò–ù–¢–ï–†–§–ï–ô–°–ê</label>
            <select id="ui-lang"><option value="ru">–†—É—Å—Å–∫–∏–π</option><option value="de">Deutsch</option></select>
            
            <label style="font-size:0.7rem; font-weight:900; margin-top:10px; display:block;">–£–†–û–í–ï–ù–¨</label>
            <select id="game-lvl" onchange="syncEditor()">
                <option value="butterfly">ü¶ã –õ—ë–≥–∫–∏–π (–ë–∞–±–æ—á–∫–∞)</option>
                <option value="dahlia">üå∏ –°—Ä–µ–¥–Ω–∏–π (–ì–µ–æ—Ä–≥–∏–Ω–∞)</option>
                <option value="house">üè† –°–ª–æ–∂–Ω—ã–π (–î–æ–º)</option>
            </select>
        </div>

        <div id="cat-container"></div>

        <div class="cat-card">
            <label style="font-size:0.7rem; font-weight:900;">–ì–†–ê–§–ò–ö–ê (–ó–ê–ú–ï–ù–ò–¢–¨)</label>
            <label class="file-label">üñº –ò–ó–ú–ï–ù–ò–¢–¨ –§–û–ù<input type="file" class="file-input" onchange="processFile(this, 'bg')"></label>
            <label class="file-label">üé® –ò–ó–ú–ï–ù–ò–¢–¨ –ì–ï–†–û–Ø<input type="file" class="file-input" onchange="processFile(this, 'hero')"></label>
        </div>
    </div>

    <div class="btn-row">
        <button class="btn btn-p" onclick="exportGame()">üì¶ –≠–ö–°–ü–û–†–¢ HTML</button>
        <button class="btn btn-a" onclick="saveState()">üíæ –°–û–•–†–ê–ù–ò–¢–¨</button>
        <button class="btn btn-iframe" onclick="generateIframe()">üîó –ü–û–õ–£–ß–ò–¢–¨ IFRAME –ö–û–î</button>
    </div>
</div>

<div class="preview-zone">
    <div style="margin-bottom:10px; font-weight:900; color:var(--p);">LIVE PREVIEW</div>
    <div class="screen" id="preview-screen" style="background-image: url('https://raw.githubusercontent.com/irinschensmagen-alt/Redaktor-/main/Background_Garden.jpg');">
        <div id="preview-obj"></div>
        <img id="preview-artist" src="https://raw.githubusercontent.com/irinschensmagen-alt/Redaktor-/main/%D0%92%D0%B5%D1%81%D1%91%D0%BB%D1%8B%D0%B9%20%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA.png">
        <img id="preview-bee" src="https://raw.githubusercontent.com/irinschensmagen-alt/Redaktor-/main/%D0%97%D0%BB%D0%B0%D1%8F%20%D0%BF%D1%87%D0%B5%D0%BB%D0%B0.png">
        <div id="preview-word">DAS HAUS</div>
    </div>
</div>

<script>
    let editorData = {
        lvl: 'butterfly',
        cats: [
            {n: 'Der', c: '#74b9ff', fx: 'none', words: 'Apfel, Tisch, Tag'},
            {n: 'Die', c: '#ff7675', fx: 'none', words: 'Lampe, Frau, Nacht'},
            {n: 'Das', c: '#55efc4', fx: 'none', words: 'Haus, Kind, Auto'}
        ]
    };

    // 1. –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –†–ï–î–ê–ö–¢–û–†–ê
    function syncEditor() {
        editorData.lvl = document.getElementById('game-lvl').value;
        const container = document.getElementById('cat-container');
        container.innerHTML = '';

        editorData.cats.forEach((cat, i) => {
            container.innerHTML += `
                <div class="cat-card">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <input type="text" value="${cat.n}" oninput="editorData.cats[${i}].n=this.value" style="width:60px; font-weight:900; border:none; border-bottom:2px solid ${cat.c}">
                        <input type="color" value="${cat.c}" onchange="editorData.cats[${i}].c=this.value; syncEditor()">
                    </div>
                    <div class="v-selector">
                        <div class="v-item ${cat.fx==='none'?'active':''}" onclick="setFX(${i}, 'none')">üö´</div>
                        <div class="v-item ${cat.fx==='fire'?'active':''}" onclick="setFX(${i}, 'fire')">üî•</div>
                        <div class="v-item ${cat.fx==='shine'?'active':''}" onclick="setFX(${i}, 'shine')">‚ú®</div>
                    </div>
                    <textarea oninput="editorData.cats[${i}].words=this.value" placeholder="–°–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é...">${cat.words}</textarea>
                </div>
            `;
        });
        updatePreview();
    }

    function setFX(catIdx, fxName) {
        editorData.cats[catIdx].fx = fxName;
        syncEditor();
    }

    // 2. –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–ï–î–ü–†–û–°–ú–û–¢–†–ê
    function updatePreview() {
        const objWrap = document.getElementById('preview-obj');
        let svg = '';

        if(editorData.lvl === 'butterfly') {
            svg = `<svg viewBox="0 0 100 100" width="100%">${Array(10).fill().map((_,i)=>`<path class="seg" d="M50 50 L${10+i*8} 20 Q50 0 ${90-i*8} 20 Z" fill="${i%2?editorData.cats[0].c : '#eee'}"/>`).join('')}</svg>`;
        } else if(editorData.lvl === 'dahlia') {
            svg = `<svg viewBox="0 0 100 100" width="100%">${Array(12).fill().map((_,i)=>`<ellipse class="seg" cx="50" cy="30" rx="10" ry="25" fill="#eee" transform="rotate(${i*30} 50 50)"/>`).join('')}</svg>`;
        } else {
            svg = `<svg viewBox="0 0 100 100" width="100%"><rect class="seg" x="20" y="40" width="60" height="50" fill="#eee"/><polygon points="20,40 80,40 50,10" fill="#eee" stroke="#333"/></svg>`;
        }
        objWrap.innerHTML = svg;
    }

    // 3. –û–ë–†–ê–ë–û–¢–ö–ê –§–ê–ô–õ–û–í –° –ü–ö (Base64)
    function processFile(input, target) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                if(target === 'bg') document.getElementById('preview-screen').style.backgroundImage = `url(${e.target.result})`;
                if(target === 'hero') document.getElementById('preview-artist').src = e.target.result;
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    // 4. –≠–ö–°–ü–û–†–¢ (–ß–ò–°–¢–ê–Ø –ò–ì–†–ê)
    function exportGame() {
        const bee = document.getElementById('preview-bee');
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø—á–µ–ª—ã –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º
        bee.animate([{left: '-100px'}, {left: '110%'}], {duration: 1000});

        setTimeout(() => {
            const clone = document.documentElement.cloneNode(true);
            clone.querySelector('.editor-sidebar').remove(); // –£–¥–∞–ª—è–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä
            clone.querySelector('.preview-zone').style.background = "none";
            clone.querySelector('.screen').style.width = "100vw";
            clone.querySelector('.screen').style.height = "100vh";
            clone.querySelector('.screen').style.borderRadius = "0";
            clone.querySelector('.screen').style.border = "none";
            
            const finalHtml = clone.outerHTML;
            const blob = new Blob([finalHtml], {type: "text/html"});
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "Deutsch_Game_Ready.html";
            a.click();
        }, 1000);
    }

    function generateIframe() {
        const code = `<iframe src="YOUR_LINK" width="100%" height="600px" frameborder="0"></iframe>`;
        prompt("–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞:", code);
    }

    function saveState() {
        localStorage.setItem('painter_save', JSON.stringify(editorData));
        alert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ!");
    }

    window.onload = syncEditor;
</script>

</body>
</html>
